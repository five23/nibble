// xgui.js r2 - https://github.com/oosmoxiecode/xgui.js
var xgui=function(n){function j(b){v(b,!0)}function q(b){w(b,!0);document.addEventListener("touchmove",j,!1);document.addEventListener("touchend",k,!1);document.addEventListener("MSPointerMove",j,!1);document.addEventListener("MSPointerUp",k,!1)}function k(b){x(b,!0);"undefined"==typeof b.changedTouches&&(b.changedTouches=[b]);0===b.changedTouches.length&&(document.removeEventListener("touchmove",j,!1),document.removeEventListener("touchend",k,!1),document.removeEventListener("MSPointerMove",j,!1),
document.removeEventListener("MSPointerUp",k,!1))}function r(b){v(b)}function y(b){w(b);document.addEventListener("mousemove",r,!1);document.addEventListener("mouseup",u,!1)}function u(b){x(b);b=l[m[0]];void 0!==b&&("ColorPicker2"!==b.name&&"ColorPicker3"!==b.name)&&(document.removeEventListener("mousemove",r,!1),document.removeEventListener("mouseup",u,!1))}function v(b,a){b.preventDefault();var c,e,f=b,g=1,h=0;a&&"undefined"==typeof b.changedTouches&&(b.changedTouches=[b]);a&&(g=b.changedTouches.length);
for(var i=0;i<g;i++){a&&(f=b.changedTouches[i],h="undefined"!=typeof f.identifier?f.identifier:"undefined"!=typeof f.pointerId?f.pointerId:0);if(!t[h]){if(null!==m[h]&&(e=l[m[h]])&&("ColorPicker2"==e.name||"ColorPicker3"==e.name))c=o.relativeMouseCoords(f),e.mouseMove(c.x-e.x,c.y-e.y);break}c=o.relativeMouseCoords(f);if((e=l[m[h]])&&"CheckBox"==e.name||"RadioButton"==e.name||"Button"==e.name||"ImageButton"==e.name||"Matrix"==e.name)break;if(e&&"Stepper"==e.name&&(e.mouseDownPlus||e.mouseDownMinus))break;
e.mouseDown(c.x-e.x,c.y-e.y)}}function w(b,a){var c=b,e=1,f=0;a&&"undefined"===typeof b.changedTouches&&(b.changedTouches=[b]);a&&(e=b.changedTouches.length);for(var h=0;h<e;h++){a&&(c=b.changedTouches[h],f="undefined"!==typeof c.identifier?c.identifier:"undefined"!=typeof c.pointerId?c.pointerId:0);var g=m[f];if(b.target===i||b.target===o)null!==m[f]&&void 0!==m[f]?l[m[f]]&&("InputText"!==l[m[f]].name&&"DropDown"!==l[m[f]].name)&&b.preventDefault():b.preventDefault();for(var k=o.relativeMouseCoords(c),
n=0;n<l.length;++n){var j=l[n];if(k.x>j.x&&k.x<j.x+j.width&&k.y>j.y&&k.y<j.y+j.height){j.mouseDown(k.x-j.x,k.y-j.y);t[f]=!0;null!==g&&(g=l[g])&&("ColorPicker2"===g.name||"ColorPicker3"===g.name)&&g.mouseUp();m[f]=j.id;break}}}}function x(b,a){var c=0;a&&"undefined"==typeof b.changedTouches&&(b.changedTouches=[b]);if(a)for(var e=b.changedTouches,f=0;f<e.length;f++){if(c="undefined"!=typeof e[f].identifier?e[f].identifier:"undefined"!=typeof e[f].pointerId?e[f].pointerId:0,t[c]=!1,null!=m[c]){var g=
l[m[c]];g.mouseUp(c)}}else t[c]=null,null!=m[c]&&(g=l[m[c]],g.mouseUp(c),"ColorPicker2"!=g.name&&"ColorPicker3"!=g.name&&(m[c]=null))}function f(b){this.constructor!=f&&(void 0==b&&(b={}),this.id=l.push(this)-1,this.x=b.x||0,this.y=b.y||0,this.updateInterval=b.updateInterval||200,this.lastUpdate=0)}function h(b){this.v=b;this.bindArray=[];this.both=this.receiver=!1}void 0===n&&(n={});var i,o,a,z=n.id||"xgui_container",l=[],t={},m={},e=n.backgroundColor||"rgb(100, 100, 100)",g=n.frontColor||"rgb(230, 230, 230)",
p=n.dimColor||"rgb(140, 140, 140)",s;this.width=n.width||600;this.height=n.height||400;i=document.createElement("div");i.style.position=n.position||"relative";i.style.width=""+this.width+"px";i.style.height=""+this.height+"px";i.setAttribute("id",z);i.style.touchAction="none";o=document.createElement("canvas");o.width=this.width;o.height=this.height;a=o.getContext("2d");i.appendChild(o);this.disableEvents=function(){document.removeEventListener("touchmove",j,!1);document.removeEventListener("touchend",
k,!1);i.removeEventListener("touchstart",q,!1);document.removeEventListener("mousemove",r,!1);document.removeEventListener("mousedown",y,!1);document.removeEventListener("mouseup",u,!1);i.removeEventListener("MSPointerMove",j,!1);i.removeEventListener("MSPointerDown",q,!1);i.removeEventListener("MSPointerUp",k,!1)};this.enableEvents=function(){i.addEventListener("touchstart",q,!1);i.addEventListener("mousedown",y,!1);i.addEventListener("MSPointerDown",q,!1)};this.enableEvents();h.prototype.bind=function(){var b=
arguments[0];if("function"==typeof b)this.bindArray.push(b);else if("object"==typeof b){for(var b=[b],a=1;a<arguments.length;++a)b.push(arguments[a]);this.bindArray.push(b)}else console.log("error")};h.prototype.updateBind=function(b){for(var b=b||!1,a=0;a<this.bindArray.length;++a){var c=this.bindArray[a];if("function"==typeof c)c(this.v,b);else if("object"==typeof c)for(var e=c[0],f=1;f<c.length;++f)this.receiver?this.v=e[c[f]]:(this.both&&(this.v=e[c[f]]),e[c[f]]=this.v);else console.log("error")}};
this.Matrix=function(b){f.call(this,b);this.name="Matrix";this.w=b.w||4;this.h=b.h||4;this.size=b.size||10;this.width=this.w*this.size+this.w-1;this.height=this.h*this.size+this.h-1;for(var a=[],c=0;c<this.h;++c){a[c]=[];for(var e=0;e<this.w;++e)a[c][e]=0}this.value=new h(b.array||a);this.draw()};this.Matrix.prototype=new f;this.Matrix.prototype.constructor=this.Matrix;this.Matrix.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);for(var b=0;b<this.h;++b)for(var d=
0;d<this.w;++d)a.fillStyle=e,a.fillRect(d*this.size+d,b*this.size+b,this.size,this.size),this.value.v[b][d]&&(a.fillStyle=g,a.fillRect(d*this.size+d+2,b*this.size+b+2,this.size-4,this.size-4));a.restore()};this.Matrix.prototype.mouseDown=function(b,a){var c=Math.floor(b/(this.size+1)),e=Math.floor(a/(this.size+1));this.value.v[e][c]=this.value.v[e][c]?0:1;this.value.updateBind();this.draw()};this.Matrix.prototype.mouseUp=function(){this.value.updateBind(!0)};this.RangeSlider=function(b){f.call(this,
b);this.name="RangeSlider";this.mouseIsOver=!1;this.value1=new h(b.value1||25);this.value2=new h(b.value2||75);this.width=b.width||100;this.height=b.height||10;this.min=b.min||0;this.max=b.max||this.width;this.range=this.max-this.min;this.decimals=b.decimals||0;this.draw()};this.RangeSlider.prototype=new f;this.RangeSlider.prototype.constructor=this.RangeSlider;this.RangeSlider.prototype.draw=function(){this.value1.v>this.max&&(this.value1.v=this.max);this.value1.v<this.min&&(this.value1.v=this.min);
this.value2.v>this.max&&(this.value2.v=this.max);this.value2.v<this.min&&(this.value2.v=this.min);this.value1.v>this.value2.v&&(this.value1.v=this.value2.v);this.value2.v<this.value1.v&&(this.value2.v=this.value1.v);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var b=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value1.v.toFixed(this.decimals),0,9+b);a.fillStyle=
g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="right";a.fillText(this.value2.v.toFixed(this.decimals),this.width-1,9+b);a.fillStyle=g;var d=this.getPositionFromValue(this.value1.v),c=this.getPositionFromValue(this.value2.v);a.fillRect(d,0,c-d,this.height);a.beginPath();a.rect(d,0,c-d,this.height);a.clip();a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value1.v.toFixed(this.decimals),0,9+b);a.fillStyle=e;a.font="11px Arial";a.textBaseline=
"alphabetic";a.textAlign="right";a.fillText(this.value2.v.toFixed(this.decimals),this.width-1,9+b);a.restore()};this.RangeSlider.prototype.setValueFromPosition=function(b,a){var c=this.range/this.width*b-(this.range-this.max);c>this.max&&(c=this.max);c<this.min&&(c=this.min);1==a?this.value1.v=c:this.value2.v=c};this.RangeSlider.prototype.getPositionFromValue=function(b){return(b-this.min)/this.range*this.width};this.RangeSlider.prototype.mouseDown=function(b){var a=this.getPositionFromValue(this.value1.v),
c=this.getPositionFromValue(this.value2.v),a=Math.abs(b-a),c=Math.abs(b-c);a<c?(this.setValueFromPosition(b,1),this.value1.updateBind()):(this.setValueFromPosition(b,2),this.value2.updateBind());this.draw()};this.RangeSlider.prototype.mouseUp=function(){this.value1.updateBind(!0);this.value2.updateBind(!0)};this.DropDown=function(b){f.call(this,b);this.name="DropDown";this.values=b.values||["DropDown"];this.texts=b.texts||this.values;this.dropdown=document.createElement("select");this.dropdown.setAttribute("id",
this.id);this.value=new h(this.values[0]);for(b=0;b<this.values.length;++b){var a=document.createElement("option");a.text=this.texts[b];a.value=this.values[b];this.dropdown.options.add(a)}b=document.createElement("canvas");b.width=16;b.height=16;a=b.getContext("2d");a.clearRect(0,0,16,16);a.fillStyle=p;a.fillRect(0,0,16,16);a.fillStyle=g;a.beginPath();a.moveTo(4.5,6);a.lineTo(12.5,6);a.lineTo(8.5,11);a.lineTo(4.5,6);a.closePath();a.fill();a.strokeStyle=e;a.beginPath();a.moveTo(0,0);a.lineTo(0,16);
a.closePath();a.stroke();a.beginPath();a.moveTo(16,0);a.lineTo(16,16);a.closePath();a.stroke();this.div=document.createElement("div");this.div.setAttribute("id","input"+this.id);this.div.style.position="absolute";this.div.style.overflow="hidden";this.div.style.left=this.x-1+"px";this.div.style.top=this.y-1+"px";this.div.style.width="101px";this.div.style.height="16px";this.div.style.background="url('"+b.toDataURL("image/png")+"') no-repeat right "+g+"";this.dropdown.style.position="absolute";this.dropdown.style.left=
"0px";this.dropdown.style.top="0px";this.dropdown.style.borderWidth="1px";this.dropdown.style.fontFamily="sans-serif";this.dropdown.style.fontSize="10px";this.dropdown.style.outlineStyle="none";this.dropdown.style.color=e;this.dropdown.style.webkitAppearance="none";this.dropdown.style.borderRadius="0px";this.dropdown.style.background="rgba(0,0,0,0)";this.dropdown.style.borderStyle="solid";this.dropdown.style.width="121px";this.dropdown.style.height="16px";this.dropdown.style.textIndent="0px";this.dropdown.style.borderLeftColor=
e;this.dropdown.style.borderTopColor=e;this.dropdown.style.borderRightColor=e;this.dropdown.style.borderBottomColor=e;i.appendChild(this.div);this.div.appendChild(this.dropdown);this.dropdown.onchange=this.onChange;this.dropdown.onfocus=this.onFocus;this.draw()};this.DropDown.prototype=new f;this.DropDown.prototype.constructor=this.DropDown;this.DropDown.prototype.onChange=function(){var b=l[this.id];b.value.v=this.value;b.value.updateBind()};this.DropDown.prototype.onFocus=function(){};this.DropDown.prototype.draw=
function(){};this.DropDown.prototype.mouseDown=function(){};this.DropDown.prototype.mouseUp=function(){};this.InputText=function(b){f.call(this,b);this.name="InputText";this.text=b.text||"";this.input=document.createElement("input");this.value=new h(this.text);this.input.value=this.value.v;this.input.type="text";this.input.setAttribute("id",this.id);this.input.style.position="absolute";this.input.style.left=this.x-1+"px";this.input.style.top=this.y-1+"px";this.input.style.borderWidth="1px";this.input.style.fontFamily=
"sans-serif";this.input.style.fontSize="10px";this.input.style.outlineStyle="none";this.input.style.color=e;this.input.style.backgroundColor=g;this.input.style.borderStyle="solid";this.input.style.width="100px";this.input.style.height="12px";this.input.style.marginLeft="0px";this.input.style.textIndent="3px";this.input.style.webkitAppearance="none";this.input.style.borderRadius="0px";this.input.style.borderLeftColor=e;this.input.style.borderTopColor=e;this.input.style.borderRightColor=e;this.input.style.borderBottomColor=
e;this.input.oninput=this.onTextChange;this.input.onfocus=this.onFocus;i.appendChild(this.input);this.draw()};this.InputText.prototype=new f;this.InputText.prototype.constructor=this.InputText;this.InputText.prototype.draw=function(){};this.InputText.prototype.onTextChange=function(){var b=l[this.id];b.value.v=this.value;b.value.updateBind()};this.InputText.prototype.onFocus=function(){};this.InputText.prototype.mouseDown=function(){};this.InputText.prototype.mouseUp=function(){};this.Stepper=function(b){f.call(this,
b);this.name="Stepper";this.mouseIsOver=!1;this.value=new h(b.value||0);this.width=b.width||60;this.height=b.height||10;this.min=b.min||-1E4;this.max=b.max||1E4;this.mouseDownPlus=this.mouseDownMinus=this.mouseDownNumber=!1;this.lastMouseY=this.lastMouseX=null;this.step=b.step||10;this.decimals=b.decimals||0;this.bx=this.width-22;this.draw()};this.Stepper.prototype=new f;this.Stepper.prototype.constructor=this.Stepper;this.Stepper.prototype.draw=function(){this.value.v<this.min&&(this.value.v=this.min);
this.value.v>this.max&&(this.value.v=this.max);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var b=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=g;this.mouseDownMinus&&(a.fillStyle=e);a.fillRect(this.bx,1,10,this.height-2);a.fillStyle=e;this.mouseDownMinus&&(a.fillStyle=g);a.fillRect(this.bx+2,4+b,6,2);a.fillStyle=g;this.mouseDownPlus&&(a.fillStyle=e);a.fillRect(this.bx+11,1,10,this.height-2);a.fillStyle=e;this.mouseDownPlus&&(a.fillStyle=g);a.fillRect(this.bx+
13,4+b,6,2);a.fillRect(this.bx+15,2+b,2,6);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.bx/2,9+b);a.restore()};this.Stepper.prototype.mouseDown=function(b,a){b<this.bx&&!this.mouseDownMinus&&!this.mouseDownPlus?(this.mouseDownNumber=!0,this.mouseDownPlus=this.mouseDownMinus=!1):b>=this.bx&&b<this.bx+11&&!this.mouseDownNumber&&!this.mouseDownPlus?(this.mouseDownMinus=!0,this.mouseDownPlus=this.mouseDownNumber=
!1,this.value.v-=this.step):b>=this.bx+11&&(!this.mouseDownNumber&&!this.mouseDownMinus)&&(this.mouseDownPlus=!0,this.mouseDownMinus=this.mouseDownNumber=!1,this.value.v+=this.step);null!=this.lastMouseX&&this.mouseDownNumber&&(this.value.v+=(b-this.lastMouseX-(a-this.lastMouseY))*this.step,this.draw());this.lastMouseX=b;this.lastMouseY=a;this.draw();this.value.updateBind()};this.Stepper.prototype.mouseUp=function(){this.mouseDownPlus=this.mouseDownMinus=this.mouseDownNumber=!1;this.lastMouseY=this.lastMouseX=
null;this.value.updateBind(!0);this.draw()};this.Graph=function(b){f.call(this,b);this.name="Graph";this.width=b.width||100;this.height=b.height||40;this.min=b.min||0;this.max=b.max||1;this.range=this.max-this.min;this.value=new h(this.min);this.draw()};this.Graph.prototype=new f;this.Graph.prototype.constructor=this.Graph;this.Graph.prototype.draw=function(){this.value.v>this.max&&(this.value.v=this.max);this.value.v<this.min&&(this.value.v=this.min);var b=a.getImageData(this.x,this.y,this.width,
this.height);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(this.x,this.y,this.width,this.height);a.fillStyle=g;a.fillRect(this.x,this.y,this.width,this.height);a.save();a.beginPath();a.rect(this.x,this.y,this.width,this.height);a.clip();var d=document.createElement("canvas");d.width=this.width;d.height=this.height;d.getContext("2d").putImageData(b,0,0);a.drawImage(d,this.x-1,this.y);a.fillStyle=p;b=this.height/this.range*(this.value.v+Math.abs(this.min));a.fillRect(this.x+this.width-1,this.y+this.height-
b,1,b);a.restore()};this.Graph.prototype.mouseDown=function(){};this.Graph.prototype.mouseUp=function(){};this.ImageButton=function(b){f.call(this,b);this.name="ImageButton";this.image=b.image||new Image;this.width=b.width||this.image.width;this.height=b.height||this.image.height;this.mouseIsDown=!1;this.value=new h(this.mouseIsDown);this.draw()};this.ImageButton.prototype=new f;this.ImageButton.prototype.constructor=this.ImageButton;this.ImageButton.prototype.draw=function(){a.clearRect(this.x,this.y,
this.width,this.height);a.globalAlpha=this.mouseIsDown?0.5:1;a.drawImage(this.image,this.x,this.y,this.width,this.height);a.globalAlpha=1};this.ImageButton.prototype.mouseDown=function(){this.mouseIsDown=!0;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.ImageButton.prototype.mouseUp=function(){this.mouseIsDown=!1;this.value.v=this.mouseIsDown;this.value.updateBind(!0);this.draw()};this.Button=function(b){f.call(this,b);this.name="Button";this.width=this.fullWidth=0;this.height=
Math.max(b.height,14)||14;this.text=b.text||"";this.mouseIsDown=!1;this.value=new h(this.mouseIsDown);this.draw();this.draw()};this.Button.prototype=new f;this.Button.prototype.constructor=this.Button;this.Button.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.width,this.height);a.fillStyle=g;this.mouseIsDown&&(a.fillStyle=p);a.fillRect(0,0,this.width,this.height);var b=Math.round(0.5*Math.max(0,this.height-14));a.fillStyle=e;this.mouseIsDown&&
(a.fillStyle=g);a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,4,11+b);b=a.measureText(this.text);this.width=Math.round(this.fullWidth+b.width)+9;a.restore()};this.Button.prototype.mouseDown=function(){this.mouseIsDown=!0;this.value.v=this.mouseIsDown;this.value.updateBind();this.draw()};this.Button.prototype.mouseUp=function(){this.mouseIsDown=!1;this.value.v=this.mouseIsDown;this.value.updateBind(!0);this.draw()};this.TrackPad=function(b){f.call(this,b);
this.name="TrackPad";this.width=b.width||100;this.height=b.height||60;this.min=b.min||-1;this.max=b.max||1;this.size=b.size||6;this.range=this.max-this.min;var a=-1*(this.range/2-this.max);this.value1=new h(b.value1||a);this.value2=new h(b.value2||a);this.draw()};this.TrackPad.prototype=new f;this.TrackPad.prototype.constructor=this.TrackPad;this.TrackPad.prototype.draw=function(){this.value1.v<this.min&&(this.value1.v=this.min);this.value1.v>this.max&&(this.value1.v=this.max);this.value2.v<this.min&&
(this.value2.v=this.min);this.value2.v>this.max&&(this.value2.v=this.max);a.save();a.translate(this.x,this.y);a.clearRect(-1,0,this.width,this.height+14);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.width,this.height);a.fillStyle=g;a.fillRect(0,0,this.width,this.height);a.strokeStyle=p;a.lineWidth=1;a.beginPath();a.moveTo(0,0.5+this.height/2);a.lineTo(0+this.width,0.5+this.height/2);a.closePath();a.stroke();a.beginPath();a.moveTo(0.5+this.width/2,0);a.lineTo(0.5+this.width/2,this.height);a.closePath();
a.stroke();var b=Math.round(this.getXPositionFromValue()),d=Math.round(this.getYPositionFromValue()),c=this.size/2;b<c&&(b=c);b>this.width-c&&(b=this.width-c);d<c&&(d=c);d>this.height-c&&(d=this.height-c);a.fillStyle=p;a.fillRect(b-c,d-c,this.size,this.size);a.fillStyle=e;a.font="8px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("X: "+this.value1.v.toFixed(2)+" Y: "+this.value2.v.toFixed(2),0,this.height+9);a.restore()};this.TrackPad.prototype.setXValueFromPosition=function(a){this.value1.v=
this.range/this.width*a-(this.range-this.max)};this.TrackPad.prototype.setYValueFromPosition=function(a){this.value2.v=this.range/this.height*a-(this.range-this.max)};this.TrackPad.prototype.getXPositionFromValue=function(){return(this.value1.v-this.min)/this.range*this.width};this.TrackPad.prototype.getYPositionFromValue=function(){return(this.value2.v-this.min)/this.range*this.height};this.TrackPad.prototype.mouseDown=function(a,d){this.setXValueFromPosition(a);this.setYValueFromPosition(d);this.draw();
this.value1.updateBind();this.value2.updateBind()};this.TrackPad.prototype.mouseUp=function(){this.value1.updateBind(!0);this.value2.updateBind(!0)};this.ColorPicker=function(a){f.call(this,a);this.name="ColorPicker";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.width=a.width||100;this.height=a.height||20;this.r=a.r||0===a.r?a.r:255;this.g=a.g||0===a.g?a.g:255;this.b=a.b||0===a.b?a.b:255;this.hex=a.hex||colorToHex("rgb("+this.r+","+this.g+","+this.b+")");this.value=new h(this.hex);
this.draw()};this.ColorPicker.prototype=new f;this.ColorPicker.prototype.constructor=this.ColorPicker;this.ColorPicker.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height+this.frameheight+4);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.width,this.height);var b=a.createLinearGradient(0,0,this.width,0),d=1/6,c=0;b.addColorStop(d*c++,"rgb(255, 0, 0)");b.addColorStop(d*c++,"rgb(255, 255, 0)");b.addColorStop(d*c++,"rgb(0, 255, 0)");b.addColorStop(d*
c++,"rgb(0, 255, 255)");b.addColorStop(d*c++,"rgb(0, 0, 255)");b.addColorStop(d*c++,"rgb(255, 0, 255)");b.addColorStop(d*c++,"rgb(255, 0, 0)");a.fillStyle=b;a.fillRect(0,0,this.width,this.height);d=1/(this.height/2);b=a.createLinearGradient(0,0,0,this.height/2);b.addColorStop(0,"rgba(255, 255, 255, 1)");b.addColorStop(d,"rgba(255, 255, 255, 1)");b.addColorStop(1,"rgba(255, 255, 255, 0)");a.fillStyle=b;a.fillRect(0,0,this.width,this.height/2);b=a.createLinearGradient(0,0+this.height/2,0,this.height);
b.addColorStop(0,"rgba(0, 0, 0, 0)");b.addColorStop(1-d,"rgba(0, 0, 0, 1)");b.addColorStop(1,"rgba(0, 0, 0, 1)");a.fillStyle=b;a.fillRect(0,this.height/2,this.width,this.height/2);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,this.height+4,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(0,this.height+4,this.framewidth,this.frameheight);b=Math.round(0.5*Math.max(0,this.frameheight-10));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+
this.value.v.toUpperCase(),this.framewidth+4,this.height+13+b);a.restore()};this.ColorPicker.prototype.mouseDown=function(b,d){0>b&&(b=0);b>this.width-1&&(b=this.width-1);0>d&&(d=0);d>this.height-1&&(d=this.height-1);var c=a.getImageData(this.x+b,this.y+d,1,1).data;this.r=c[0];this.g=c[1];this.b=c[2];this.hex=colorToHex("rgb("+this.r+","+this.g+","+this.b+")");this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker.prototype.mouseUp=function(){this.value.updateBind(!0)};this.ColorPicker2=
function(a){f.call(this,a);this.name="ColorPicker2";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.colorwidth=a.width||100;this.colorheight=a.height||30;this.width=this.framewidth;this.height=this.frameheight;this.r=a.r||0===a.r?a.r:255;this.g=a.g||0===a.g?a.g:255;this.b=a.b||0===a.b?a.b:255;this.oldColor={r:this.r,g:this.g,b:this.b};this.mousehack=this.open=!1;this.lastTime=0;this.hex=a.hex||colorToHex("rgb("+this.r+","+this.g+","+this.b+")");this.value=new h(this.hex);
this.draw()};this.ColorPicker2.prototype=new f;this.ColorPicker2.prototype.constructor=this.ColorPicker2;this.ColorPicker2.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(-1,-1,this.framewidth+60,this.height+3);a.clearRect(-1,this.frameheight,this.colorwidth+2,this.colorheight+3);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(0,0,this.framewidth,this.frameheight);var b=Math.round(0.5*Math.max(0,this.frameheight-
11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.framewidth+4,9+b);if(this.open){a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,this.frameheight+1,this.colorwidth,this.colorheight);var b=a.createLinearGradient(0,this.frameheight+1,this.colorwidth,this.frameheight+1),d=1/6,c=0;b.addColorStop(d*c++,"rgb(255, 0, 0)");b.addColorStop(d*c++,"rgb(255, 255, 0)");b.addColorStop(d*c++,"rgb(0, 255, 0)");b.addColorStop(d*c++,"rgb(0, 255, 255)");
b.addColorStop(d*c++,"rgb(0, 0, 255)");b.addColorStop(d*c++,"rgb(255, 0, 255)");b.addColorStop(d*c++,"rgb(255, 0, 0)");a.fillStyle=b;a.fillRect(0,this.frameheight+1,this.colorwidth,this.colorheight);d=1/(this.colorheight/2);b=a.createLinearGradient(0,this.frameheight+1,0,this.frameheight+1+this.colorheight/2);b.addColorStop(0,"rgba(255, 255, 255, 1)");b.addColorStop(d,"rgba(255, 255, 255, 1)");b.addColorStop(1,"rgba(255, 255, 255, 0)");a.fillStyle=b;a.fillRect(0,this.frameheight+1,this.colorwidth,
this.colorheight/2);b=a.createLinearGradient(0,0+this.frameheight+1+this.colorheight/2,0,this.frameheight+1+this.colorheight);b.addColorStop(0,"rgba(0, 0, 0, 0)");b.addColorStop(1-d,"rgba(0, 0, 0, 1)");b.addColorStop(1,"rgba(0, 0, 0, 1)");a.fillStyle=b;a.fillRect(0,this.frameheight+1+this.colorheight/2,this.colorwidth,this.colorheight/2)}a.restore()};this.ColorPicker2.prototype.mouseDown=function(a,d){if(!(200>(new Date).getTime()-this.lastTime)&&(this.open&&(0<a&&a<this.colorwidth-1&&d>this.frameheight&&
d<this.frameheight+this.colorheight)&&(this.mouseMove(a,d),this.oldColor={r:this.r,g:this.g,b:this.b}),!this.open&&d<this.frameheight?this.open=!0:this.open&&(this.open=!1),this.open?(this.width=this.colorwidth,this.height=this.frameheight+this.colorheight):(this.width=this.framewidth,this.height=this.frameheight),this.draw(),this.mousehack=!1,this.lastTime=(new Date).getTime(),!this.open))for(var c=0;c<l.length;++c)l[c].draw()};this.ColorPicker2.prototype.setOldColor=function(){this.r=this.oldColor.r;
this.g=this.oldColor.g;this.b=this.oldColor.b;this.hex=colorToHex("rgb("+this.r+","+this.g+","+this.b+")")};this.ColorPicker2.prototype.mouseMove=function(b,d){var c=!1;0>b&&(b=0,this.setOldColor(),c=!0);b>this.colorwidth-1&&(b=this.colorwidth-1,this.setOldColor(),c=!0);d<=this.frameheight&&(d=this.frameheight,this.setOldColor(),c=!0);d>this.frameheight+this.colorheight&&(d=this.frameheight+this.colorheight,this.setOldColor(),c=!0);c||(c=a.getImageData(this.x+b,this.y+d,1,1).data,this.r=c[0],this.g=
c[1],this.b=c[2],this.hex=colorToHex("rgb("+this.r+","+this.g+","+this.b+")"));this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker2.prototype.mouseUp=function(a){this.open||(m[a]=null);this.mousehack&&(this.setOldColor(),this.mouseDown(),m[a]=null);this.mousehack=!0;this.value.updateBind(!0)};this.ColorPicker3=function(a){f.call(this,a);this.name="ColorPicker3";this.framewidth=a.framewidth||10;this.frameheight=a.frameheight||10;this.maxWidth=a.maxWidth||12;this.size=a.size||
10;this.palette=a.palette||["ffffff","000000"];this.colorwidth=this.maxWidth*this.size;this.colorheight=Math.ceil(this.palette.length/this.maxWidth)*this.size;this.width=this.framewidth;this.height=this.frameheight;this.current=a.current||0;this.current>=this.palette.length&&(this.current=this.palette.length-1);this.mousehack=this.open=!1;this.lastTime=0;this.oldColor=this.hex=this.palette[this.current];this.oldCurrent=this.current;this.value=new h(this.hex);this.draw()};this.ColorPicker3.prototype=
new f;this.ColorPicker3.prototype.constructor=this.ColorPicker3;this.ColorPicker3.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(-1,-1,this.framewidth+60,this.height+3);a.clearRect(-1,this.frameheight,this.colorwidth+2,this.colorheight+3);a.strokeStyle=e;a.lineWidth=2;a.strokeRect(0,0,this.framewidth,this.frameheight);a.fillStyle="#"+this.value.v;a.fillRect(0,0,this.framewidth,this.frameheight);var b=Math.round(0.5*Math.max(0,this.frameheight-11));a.fillStyle=e;a.font="11px Arial";
a.textBaseline="alphabetic";a.textAlign="left";a.fillText("#"+this.value.v.toUpperCase(),this.framewidth+4,9+b);if(this.open){for(var d=b=0,c,f,g=0;g<this.palette.length;g++)if(g==this.current&&(c=b,f=d),a.strokeRect(b*this.size,this.frameheight+d*this.size+1,this.size,this.size),a.fillStyle="#"+this.palette[g],a.fillRect(b*this.size,this.frameheight+d*this.size+1,this.size,this.size),++b,b>=this.maxWidth)b=0,++d;a.strokeStyle="#ffffff";a.lineWidth=2;a.strokeRect(c*this.size,this.frameheight+f*this.size+
1,this.size,this.size)}a.restore()};this.ColorPicker3.prototype.setOldColor=function(){this.hex=this.oldColor;this.current=this.oldCurrent};this.ColorPicker3.prototype.mouseDown=function(a,d){if(!(200>(new Date).getTime()-this.lastTime)&&(this.open&&(0<a&&a<this.colorwidth-1&&d>this.frameheight&&d<this.frameheight+this.colorheight)&&(this.mouseMove(a,d),this.oldColor=this.hex,this.oldCurrent=this.current),!this.open&&d<this.frameheight?this.open=!0:this.open&&(this.open=!1),this.open?(this.width=
this.colorwidth,this.height=this.frameheight+this.colorheight):(this.width=this.framewidth,this.height=this.frameheight),this.draw(),this.mousehack=!1,this.lastTime=(new Date).getTime(),!this.open))for(var c=0;c<l.length;++c)l[c].draw()};this.ColorPicker3.prototype.mouseMove=function(b,d){var c=!1;0>b&&(b=0,this.setOldColor(),c=!0);b>this.colorwidth-1&&(b=this.colorwidth-1,this.setOldColor(),c=!0);d<=this.frameheight&&(d=this.frameheight,this.setOldColor(),c=!0);d>=this.frameheight+this.colorheight&&
(d=this.frameheight+this.colorheight,this.setOldColor(),c=!0);if(!c){var c=Math.floor(b/this.size),e=Math.floor((d-this.frameheight)/this.size),f=c*this.size+Math.ceil(0.5*this.size),g=e*this.size+Math.ceil(0.5*this.size);this.current=e*this.maxWidth+c;c=a.getImageData(this.x+1+f,this.y+this.frameheight+1+g,1,1).data;this.hex=colorToHex("rgb("+c[0]+","+c[1]+","+c[2]+")")}this.value.v=this.hex;this.value.updateBind();this.draw()};this.ColorPicker3.prototype.mouseUp=function(a){this.open||(m[a]=null);
this.mousehack&&(this.setOldColor(),this.mouseDown(),m[a]=null);this.mousehack=!0;this.value.updateBind(!0)};this.Knob=function(a){f.call(this,a);this.name="Knob";this.radius=a.radius||15;this.width=2*this.radius;this.height=2*this.radius;this.min=a.min||0;this.max=a.max||100;this.range=this.max-this.min;this.value=new h(a.value||0);this.mPI=0.8*Math.PI;this.lastRotationValue=this.rotationValue=this.getRotationValue();this.decimals=a.decimals||0;this.draw()};this.Knob.prototype=new f;this.Knob.prototype.constructor=
this.Knob;this.Knob.prototype.getRotationValue=function(){return(this.value.v-this.min)/(this.max-this.min)*(this.mPI- -this.mPI)-this.mPI};this.Knob.prototype.draw=function(){this.value.v<this.min&&(this.value.v=this.min);this.value.v>this.max&&(this.value.v=this.max);a.save();a.translate(this.x,this.y);a.clearRect(-4,-4,this.width+8,this.height+13);a.fillStyle=e;a.beginPath();a.arc(this.radius,this.radius,this.radius,0,2*Math.PI,!1);a.closePath();a.fill();var b=Math.PI+this.mPI,d=(b-(Math.PI-this.mPI))/
this.radius;a.strokeStyle=e;a.lineWidth=0.5;for(var c=0;c<=this.radius;++c){var f=this.radius+Math.sin(b-d*c)*(this.radius+1),h=this.radius+Math.cos(b-d*c)*(this.radius+1),i=this.radius+Math.sin(b-d*c)*(this.radius+4),j=this.radius+Math.cos(b-d*c)*(this.radius+4);a.beginPath();a.moveTo(f,h);a.lineTo(i,j);a.closePath();a.stroke()}b=this.radius+Math.cos(this.rotationValue-0.5*Math.PI)*this.radius;d=this.radius+Math.sin(this.rotationValue-0.5*Math.PI)*this.radius;a.strokeStyle=g;a.lineWidth=2;a.beginPath();
a.moveTo(this.radius,this.radius);a.lineTo(b,d);a.closePath();a.stroke();a.fillStyle=e;a.font="8px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.radius,2*this.radius+7);a.restore()};this.Knob.prototype.mouseDown=function(a,d){this.rotationValue=-1*Math.atan2(this.radius-a,this.radius-d);this.rotationValue>this.mPI&&(this.rotationValue=this.mPI);this.rotationValue<-this.mPI&&(this.rotationValue=-this.mPI);Math.abs(this.rotationValue-this.lastRotationValue)>
Math.PI&&(this.rotationValue=this.lastRotationValue);this.value.v=this.range*(this.rotationValue- -this.mPI)*(1/(this.mPI- -this.mPI))+this.min;this.draw();this.value.updateBind();this.lastRotationValue=this.rotationValue};this.Knob.prototype.mouseUp=function(){this.value.updateBind(!0)};this.CheckBox=function(a){f.call(this,a);this.name="CheckBox";this.text=a.text||"";this.value=new h(a.selected||!1);this.width=this.fullWidth=a.width||10;this.height=a.height||10;this.draw()};this.CheckBox.prototype=
new f;this.CheckBox.prototype.constructor=this.CheckBox;this.CheckBox.prototype.draw=function(){a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);a.fillStyle=e;a.fillRect(0,0,this.fullWidth,this.height);a.fillStyle=this.value.v?g:e;a.fillRect(2,2,this.fullWidth-4,this.height-4);var b=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.fullWidth+2,9+b);this.width=this.fullWidth+
a.measureText(this.text).width+3;a.restore()};this.CheckBox.prototype.mouseDown=function(){this.value.v=this.value.v?!1:!0;this.value.updateBind();this.draw()};this.CheckBox.prototype.mouseUp=function(){this.value.updateBind(!0)};this.RadioButtonGroup=function(){this.name="RadioButtonGroup";this.array=[];this.value=new h([])};this.RadioButtonGroup.prototype.add=function(a){this.array.push(a);this.value.v.push(a.value.v);a.group=this};this.RadioButtonGroup.prototype.clear=function(a){for(var d=0;d<
this.array.length;++d){var c=this.array[d];c==a?this.value.v[d]=!0:(this.value.v[d]=!1,c.value.v=!1,c.value.updateBind(),c.draw())}this.value.updateBind()};this.RadioButton=function(a){f.call(this,a);this.name="RadioButton";this.group=null;this.text=a.text||"";this.value=new h(a.selected||!1);this.width=this.fullWidth=a.width||18;this.height=a.height||10;this.draw()};this.RadioButton.prototype=new f;this.RadioButton.prototype.constructor=this.RadioButton;this.RadioButton.prototype.draw=function(){a.save();
a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);a.fillStyle=e;a.fillRect(0,0,this.fullWidth,this.height);this.value.v?(a.fillStyle=g,a.fillRect(this.fullWidth/2+1,2,this.fullWidth/2-3,this.height-4)):(a.fillStyle=p,a.fillRect(2,2,this.fullWidth/2-3,this.height-4));var b=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.text,this.fullWidth+2,9+b);this.width=this.fullWidth+a.measureText(this.text).width+
3;a.restore()};this.RadioButton.prototype.mouseDown=function(){this.group.clear(this);this.value.v||(this.value.v=!0);this.value.updateBind();this.draw()};this.RadioButton.prototype.mouseUp=function(){this.value.updateBind(!0)};this.RadioButton.prototype.mouseMove=function(){};this.HSlider=function(a){f.call(this,a);this.name="HSlider";this.mouseIsOver=!1;this.value=new h(a.value||0);this.width=a.width||100;this.height=a.height||10;this.min=a.min||0;this.max=a.max||this.width;this.range=this.max-
this.min;this.decimals=a.decimals||0;this.draw()};this.HSlider.prototype=new f;this.HSlider.prototype.constructor=this.HSlider;this.HSlider.prototype.draw=function(){this.value.v>this.max&&(this.value.v=this.max);this.value.v<this.min&&(this.value.v=this.min);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var b=Math.round(0.5*Math.max(0,this.height-11));a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),
0,9+b);var d=this.getPositionFromValue();a.fillStyle=g;a.fillRect(0,0,d,this.height);a.beginPath();a.rect(0,0,d,this.height);a.clip();a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,9+b);a.restore()};this.HSlider.prototype.setValueFromPosition=function(a){this.value.v=this.range/this.width*a-(this.range-this.max)};this.HSlider.prototype.getPositionFromValue=function(){return(this.value.v-this.min)/this.range*this.width};
this.HSlider.prototype.mouseDown=function(a){this.setValueFromPosition(a);this.draw();this.value.updateBind()};this.HSlider.prototype.mouseUp=function(){this.value.updateBind(!0)};this.VSlider=function(a){f.call(this,a);this.name="VSlider";this.mouseIsOver=!1;this.value=new h(a.value||0);this.width=a.width||10;this.height=a.height||100;this.min=a.min||0;this.max=a.max||this.height;this.decimals=a.decimals||0;this.range=this.max-this.min;this.draw()};this.VSlider.prototype=new f;this.VSlider.prototype.constructor=
this.VSlider;this.VSlider.prototype.draw=function(){this.value.v>this.max&&(this.value.v=this.max);this.value.v<this.min&&(this.value.v=this.min);a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,this.height);var b=Math.round(0.5*Math.max(0,this.width-11));a.save();a.translate(9+b,this.height-1);a.rotate(-Math.PI/2);a.fillStyle=g;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,0);a.restore();var d=this.getPositionFromValue();
a.fillStyle=g;a.fillRect(0,d,this.width,this.height-d);a.translate(9+b,this.height-1);a.rotate(-Math.PI/2);a.beginPath();a.rect(-1,-this.width+1,this.height-d,this.width);a.clip();a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v.toFixed(this.decimals),0,0);a.restore()};this.VSlider.prototype.setValueFromPosition=function(a){this.value.v=this.range-this.range/this.height*a-(this.range-this.max)};this.VSlider.prototype.getPositionFromValue=function(){return this.height-
(this.value.v-this.min)/this.range*this.height};this.VSlider.prototype.mouseDown=function(a,d){this.setValueFromPosition(d);this.draw();this.value.updateBind()};this.VSlider.prototype.mouseUp=function(){this.value.updateBind(!0)};this.Joystick=function(a){f.call(this,a);this.name="Joystick";this.value1=new h(0);this.value2=new h(0);this.radius=a.radius||50;this.innerRadius=a.innerRadius||0.65*this.radius;this.width=2*this.radius;this.height=2*this.radius;this.sticky=this.stickx=0;this.laststicky=
this.laststickx=-1;this.maxDistance=this.radius-this.innerRadius-5;this.doUpdate=this.mouseIsDown=!1;this.draw()};this.Joystick.prototype=new f;this.Joystick.prototype.constructor=this.Joystick;this.Joystick.prototype.draw=function(b){this.mouseIsDown||(this.stickx+=(0-this.stickx)/3,this.sticky+=(0-this.sticky)/3);if(this.stickx.toFixed(2)==this.laststickx.toFixed(2)&&this.sticky.toFixed(2)==this.laststicky.toFixed(2)&&b)this.doUpdate=!1;else{this.doUpdate=!0;this.value1.v=this.stickx/this.maxDistance;
this.value2.v=this.sticky/this.maxDistance;a.save();a.translate(this.x,this.y);a.clearRect(-2,-2,this.width+14,this.height+14);b=a.createRadialGradient(this.radius,this.radius,0,this.radius,this.radius,this.radius+5);b.addColorStop(0,p);b.addColorStop(0.8,g);b.addColorStop(1,p);a.fillStyle=b;a.beginPath();a.arc(this.radius,this.radius,this.radius,0,2*Math.PI,!1);a.closePath();a.fill();var d=5*(1-this.value1.v),c=5*(1-this.value2.v),b=a.createRadialGradient(this.radius+this.stickx+d,this.radius+this.sticky+
c,0,this.radius+this.stickx+d,this.radius+this.sticky+c,this.innerRadius+10);b.addColorStop(0,"rgba(0,0,0,1)");b.addColorStop(1,"rgba(0,0,0,0.00001)");a.fillStyle=b;a.beginPath();a.arc(this.radius+this.stickx+d,this.radius+this.sticky+c,this.innerRadius+10,0,2*Math.PI,!1);a.closePath();a.fill();b=a.createLinearGradient(this.radius+this.stickx-this.innerRadius,this.radius+this.sticky-this.innerRadius,this.radius+this.stickx-this.innerRadius,this.radius+this.sticky+this.innerRadius);b.addColorStop(0,
g);b.addColorStop(1,p);a.fillStyle=b;a.beginPath();a.arc(this.radius+this.stickx,this.radius+this.sticky,this.innerRadius,0,2*Math.PI,!1);a.closePath();a.fill();b=a.createRadialGradient(this.radius+this.stickx,this.radius+this.sticky,0,this.radius+this.stickx,this.radius+this.sticky,this.radius);b.addColorStop(0,g);b.addColorStop(1,p);a.fillStyle=b;a.beginPath();a.arc(this.radius+this.stickx,this.radius+this.sticky,this.innerRadius-4,0,2*Math.PI,!1);a.closePath();a.fill();this.laststickx=this.stickx;
this.laststicky=this.sticky;a.restore()}};this.Joystick.prototype.mouseDown=function(a,d){this.mouseIsDown=!0;this.stickx=a-this.radius;this.sticky=d-this.radius;if(Math.sqrt(this.stickx*this.stickx+this.sticky*this.sticky)>this.maxDistance){var c=Math.atan2(this.stickx,this.sticky);this.stickx=Math.sin(c)*this.maxDistance;this.sticky=Math.cos(c)*this.maxDistance}this.draw();this.value1.updateBind();this.value2.updateBind()};this.Joystick.prototype.mouseUp=function(){this.mouseIsDown=!1;this.doUpdate=
!0;this.value1.updateBind(!0);this.value2.updateBind(!0)};this.CircularSlider=function(a){f.call(this,a);this.name="CircularSlider";this.radius=a.radius||25;this.innerRadius=a.innerRadius||this.radius-10;this.width=2*this.radius;this.height=2*this.radius;this.min=a.min||0;this.max=a.max||100;this.range=this.max-this.min;this.value=new h(a.value||0);this.lastRotationValue=this.rotationValue=this.getRotationValue();this.decimals=a.decimals||0;this.draw()};this.CircularSlider.prototype=new f;this.CircularSlider.prototype.constructor=
this.CircularSlider;this.CircularSlider.prototype.getRotationValue=function(){return(this.value.v-this.min)/(this.max-this.min)*2*Math.PI};this.CircularSlider.prototype.draw=function(){this.value.v<this.min&&(this.value.v=this.min);this.value.v>this.max&&(this.value.v=this.max);a.save();a.translate(this.x,this.y);a.clearRect(0,0,this.width,this.height);a.fillStyle=e;a.beginPath();a.arc(this.radius,this.radius,this.radius,0.5*-Math.PI,1.5*Math.PI,!1);a.closePath();a.fill();a.fillStyle=g;a.beginPath();
a.moveTo(this.radius,this.radius);a.lineTo(this.radius,0);a.arc(this.radius,this.radius,this.radius,0.5*-Math.PI,this.rotationValue-0.5*Math.PI,!1);a.closePath();a.fill();a.globalCompositeOperation="destination-out";a.beginPath();a.arc(this.radius,this.radius,this.innerRadius,0.5*-Math.PI,1.5*Math.PI,!1);a.closePath();a.fill();a.globalCompositeOperation="source-over";a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="center";a.fillText(this.value.v.toFixed(this.decimals),this.radius,
this.radius+4);a.restore()};this.CircularSlider.prototype.mouseDown=function(a,d){this.rotationValue=Math.atan2(this.radius-d,this.radius-a)-0.5*Math.PI;var c=2*Math.PI;this.rotationValue=(this.rotationValue%c+c)%c;Math.abs(this.rotationValue-this.lastRotationValue)>Math.PI&&(this.rotationValue=this.lastRotationValue);this.value.v=this.range*this.rotationValue*(1/c)+this.min;this.draw();this.value.updateBind();this.lastRotationValue=this.rotationValue};this.CircularSlider.prototype.mouseUp=function(){this.value.updateBind(!0)};
this.Scrollwheel=function(a){f.call(this,a);this.name="Scrollwheel";this.width=a.width||20;this.height=a.height||80;this.centerx=this.x+0.5*this.width;this.centery=this.y+0.5*this.height;this.min=a.min||-1;this.max=a.max||1;this.range=this.max-this.min;this.value=new h(a.value||0);this.lastValue=this.value.v;this.decimals=a.decimals||2;this.pattern=document.createElement("canvas");this.pattern.width=this.width;this.pattern.height=3*this.height;for(var a=this.pattern.getContext("2d"),d=[g,p],c=0;c<
this.pattern.height;c+=2)a.fillStyle=d[0.5*c%2],a.fillRect(0,c,128,2);this.mouseStartY=null;this.offsetY=this.mouseOffsetY=0;this.doUpdate=!0;this.draw()};this.Scrollwheel.prototype=new f;this.Scrollwheel.prototype.constructor=this.Scrollwheel;this.Scrollwheel.prototype.draw=function(){this.value.v<this.min&&(this.value.v=this.min);this.value.v>this.max&&(this.value.v=this.max);this.offsetY+=(this.mouseOffsetY-this.offsetY)/10;a.save();a.translate(this.x,this.y);a.fillStyle=e;a.fillRect(0,0,this.width,
this.height);a.save();a.beginPath();a.rect(2,2,this.width-4,this.height-4);a.clip();a.drawImage(this.pattern,0,-this.height+this.offsetY);a.restore();var b=a.createLinearGradient(0,0,0,this.height);b.addColorStop(0,"rgba(0,0,0,0.7)");b.addColorStop(0.4,"rgba(0,0,0,0)");b.addColorStop(0.6,"rgba(0,0,0,0)");b.addColorStop(1,"rgba(0,0,0,0.7)");a.fillStyle=b;a.fillRect(0,0,this.width,this.height);this.value.v=(this.range*((this.offsetY+this.height)/(2*this.height))+this.min).toFixed(this.decimals);this.value.v!=
this.lastValue?(this.value.updateBind(),this.doUpdate=!0):this.doUpdate=!1;this.lastValue=this.value.v;a.restore()};this.Scrollwheel.prototype.mouseDown=function(a,d){null==this.mouseStartY&&(this.mouseStartY=d);this.mouseOffsetY=d-this.mouseStartY;this.mouseOffsetY>this.height&&(this.mouseOffsetY=this.height);this.mouseOffsetY<-this.height&&(this.mouseOffsetY=-this.height);this.draw()};this.Scrollwheel.prototype.mouseUp=function(){this.mouseStartY=null;this.mouseOffsetY=0;this.doUpdate=!0;this.value.updateBind(!0)};
this.Label=function(a){f.call(this,a);this.name="Label";this.group=null;this.value=new h(a.text||"");this.width=0;this.height=13;this.draw()};this.Label.prototype=new f;this.Label.prototype.constructor=this.Label;this.Label.prototype.draw=function(){a.clearRect(this.x,this.y,this.width,this.height);a.fillStyle=e;a.font="11px Arial";a.textBaseline="alphabetic";a.textAlign="left";a.fillText(this.value.v,this.x,this.y+9);this.width=a.measureText(this.value.v).width+3};this.Label.prototype.mouseDown=
function(){};this.Label.prototype.mouseUp=function(){};this.onResize=function(){i.style.width=""+this.width+"px";i.style.height=""+this.height+"px";o.width=this.width;o.height=this.height};this.dispose=function(){this.disableEvents();l.length=0;i.removeChild(o);i.innerHTML="";document.getElementById(z).parentNode.removeChild(i);for(var a in this)delete this[a]};this.update=function(){s=Date.now();for(var a=0;a<l.length;++a){var d=l[a];if("Joystick"==d.name||"Scrollwheel"==d.name)d.doUpdate&&d.draw(!0);
else{if(d.value&&(d.value.receiver||d.value.both)&&s>d.lastUpdate+d.updateInterval)d.value.updateBind(),d.draw(),d.lastUpdate=s;if(d.value1){var c=!1;if((d.value1.receiver||d.value1.both)&&s>d.lastUpdate+d.updateInterval)d.value1.updateBind(),c=!0;if((d.value2.receiver||d.value2.both)&&s>d.lastUpdate+d.updateInterval)d.value2.updateBind(),c=!0;c&&(d.draw(),d.lastUpdate=s)}}}};return{getDomElement:function(){return i},getContext:function(){return a},HSlider:this.HSlider,VSlider:this.VSlider,Label:this.Label,
RadioButton:this.RadioButton,RadioButtonGroup:this.RadioButtonGroup,CheckBox:this.CheckBox,Knob:this.Knob,ColorPicker:this.ColorPicker,ColorPicker2:this.ColorPicker2,ColorPicker3:this.ColorPicker3,TrackPad:this.TrackPad,Button:this.Button,ImageButton:this.ImageButton,Graph:this.Graph,Stepper:this.Stepper,InputText:this.InputText,DropDown:this.DropDown,Matrix:this.Matrix,RangeSlider:this.RangeSlider,Joystick:this.Joystick,CircularSlider:this.CircularSlider,Scrollwheel:this.Scrollwheel,update:this.update,
onResize:this.onResize,disableEvents:this.disableEvents,enableEvents:this.enableEvents,dispose:this.dispose}};function colorToHex(n){var j=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(n);return j?(16777216|j[1]<<16|j[2]<<8|j[3]).toString(16).substr(1):n}
HTMLCanvasElement.prototype.relativeMouseCoords=function(n){var j=0,q=0,k=0,r=0,k=this;do j+=k.offsetLeft,q+=k.offsetTop;while(k=k.offsetParent);k=n.pageX-j;r=n.pageY-q;k=Math.round(k*(this.width/this.offsetWidth));r=Math.round(r*(this.height/this.offsetHeight));return{x:k,y:r}};
